---
meta:
  author: airween
  description: "A Selection of tests to trigger rule 920171"
rule_id: 920171
tests:
  - # POST Request with data (valid)
    test_id: 1
    stages:
      - input:
          dest_addr: "127.0.0.1"
          port: 80
          # this sends a chunked POST request with content "Hi CRS" in two lines
          # POST / HTTP/1.1
          # Accept: */*
          # Host: localhost
          # Transfer-Encoding: chunked
          # User-Agent: "OWASP CRS test agent"
          #
          # 3
          # Hi
          # 3
          # CRS
          # 0
          #
          encoded_request: "UE9TVCAvIEhUVFAvMS4xDQpBY2NlcHQ6ICovKg0KSG9zdDogbG9jYWxob3N0DQpUcmFuc2Zlci1FbmNvZGluZzogY2h1bmtlZA0KVXNlci1BZ2VudDogTW9kU2VjdXJpdHkgQ1JTIDMgVGVzdHMNCg0KMw0KSGkgDQozDQpDUlMNCjANCg0K"
        output:
          no_log_contains: "id \"920171\""
  - # GET Request with chunked data (invalid)
    test_id: 2
    stages:
      - input:
          dest_addr: "127.0.0.1"
          port: 80
          # this sends a chunked GET request with content "Hi CRS" in two lines
          # GET / HTTP/1.1
          # Accept: */*
          # Host: localhost
          # Transfer-Encoding: chunked
          # User-Agent: "OWASP CRS test agent"
          #
          # 3
          # Hi
          # 3
          # CRS
          # 0
          #
          encoded_request: "R0VUIC8gSFRUUC8xLjENCkFjY2VwdDogKi8qDQpIb3N0OiBsb2NhbGhvc3QNClRyYW5zZmVyLUVuY29kaW5nOiBjaHVua2VkDQpVc2VyLUFnZW50OiBNb2RTZWN1cml0eSBDUlMgMyBUZXN0cw0KDQozDQpIaSANCjMNCkNSUw0KMA0KDQo="
        output:
          log_contains: "id \"920171\""
  - # HEAD Request with chunked data (invalid)
    test_id: 3
    stages:
      - input:
          dest_addr: "127.0.0.1"
          port: 80
          # this sends a chunked HEAD request with content "Hi CRS" in two lines
          # HEAD / HTTP/1.1
          # Accept: */*
          # Host: localhost
          # Transfer-Encoding: chunked
          # User-Agent: "OWASP CRS test agent"
          #
          # 3
          # Hi
          # 3
          # CRS
          # 0
          #
          encoded_request: "SEVBRCAvIEhUVFAvMS4xDQpBY2NlcHQ6ICovKg0KSG9zdDogbG9jYWxob3N0DQpUcmFuc2Zlci1FbmNvZGluZzogY2h1bmtlZA0KVXNlci1BZ2VudDogTW9kU2VjdXJpdHkgQ1JTIDMgVGVzdHMNCg0KMw0KSGkgDQozDQpDUlMNCjANCg0K"
        output:
          log_contains: "id \"920171\""
